<?xml version="1.0" encoding="UTF-8"?>
<!-- edited with XMLSpy v2015 sp2 (http://www.altova.com) by Dennis (Webfly) -->
<job xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="file:///C:/Work/workspace/incredible/smartETL/src/main/resources/job.xsd">
	<name/>
	<properties></properties>
	<steps>
		<step>
			<name>step1-CSVInput</name>
			<type>CSVInputStep</type>
			<variables>
				<variable>
					<name>v1</name>
					<formula>[firstname]</formula>
				</variable>
			</variables>
			<!-- filter>left([v1];1)="j"</filter-->
			<filter>nullempty([v1])&lt;&gt;""</filter>
			<file>C:\Work\workspace\incredible\examples\customers1.txt</file>
			<title>true</title>
			<delimiter>;</delimiter>
			<quote/>
			<datadef ref="customer"/>
			<!--topskipcount>2</topskipcount-->
			<bottomskipcount>10</bottomskipcount>
		</step>
		<step>
			<name>step6-CSVInput</name>
			<type>CSVInputStep</type>
			<file>C:\Work\workspace\incredible\examples\state.txt</file>
			<title>true</title>
			<delimiter>;</delimiter>
			<quote/>
			<datadef ref="state"/>
		</step>
		<step>
			<name>step5-Join</name>
			<type>JoinStep</type>
			<jointype>LEFT OUTER</jointype>
			<leftstep>
				<name>step7-sort</name>
				<keys>
					<field>zip</field>
					<field>stateCode</field>
				</keys>
			</leftstep>
			<rightstep>
				<name>step71-sort</name>
				<keys>
					<field>zip</field>
					<field>stateCode</field>
				</keys>
			</rightstep>
		</step>
		<step>
			<name>step2-Dummy</name>
			<type>DummyStep</type>
			<debug>true</debug>
		</step>
		<step>
			<name>step3-CSVOutputSep</name>
			<type>CSVOutputStep</type>
			<file>C:\Work\workspace\smartETLTest\output\outputcustomers.txt</file>
			<title>true</title>
			<delimiter>;</delimiter>
			<quote/>
			<!-- datadef ref="outputcustomer"/-->
		</step>
		<step>
			<name>step1Output</name>
			<type>CSVOutputStep</type>
			<file>C:\Work\workspace\smartETLTest\output\customers_cmbi.txt</file>
			<title>true</title>
			<delimiter>;</delimiter>
			<quote/>
			<!-- datadef ref="outputcustomer"/-->
		</step>
		<step>
			<name>step 4-smart trans step</name>
			<type>SmartTransStep</type>
			<datadef ref="outputcustomer"/>
			<!--tag value="HK" formula="HK1"/-->
			<tag formula="&quot;HK&quot;"/>
			<variables>
				<variable>
					<name>v1</name>
					<formula>[firstname]</formula>
				</variable>
				<variable>
					<name>v2</name>
					<formula>"A"</formula>
				</variable>
			</variables>
##mappings##
		</step>
		<step>
			<name>step7-sort</name>
			<type>SortStep</type>
			<tempdirectory>C:\Work\workspace\smartETLTest\temp</tempdirectory>
			<prefix>sort_</prefix>
			<sortsize>200</sortsize>
			<compress>true</compress>
			<uniquerows>false</uniquerows>
			<fields>
				<field>
					<name>zip</name>
					<ascending>true</ascending>
					<casesensitive>true</casesensitive>
					<presorted>false</presorted>
				</field>
				<field>
					<name>stateCode</name>
					<ascending>true</ascending>
					<casesensitive>true</casesensitive>
					<presorted>false</presorted>
				</field>
			</fields>
		</step>
		<step>
			<name>step71-sort</name>
			<type>SortStep</type>
			<tempdirectory>C:\Work\workspace\smartETLTest\temp</tempdirectory>
			<prefix>sort_</prefix>
			<sortsize>200</sortsize>
			<compress>true</compress>
			<uniquerows>false</uniquerows>
			<fields>
				<field>
					<name>zip</name>
					<ascending>true</ascending>
					<casesensitive>true</casesensitive>
					<presorted>false</presorted>
				</field>
				<field>
					<name>stateCode</name>
					<ascending>true</ascending>
					<casesensitive>true</casesensitive>
					<presorted>false</presorted>
				</field>
			</fields>
		</step>
		<step>
			<name>step8-sort</name>
			<type>SortStep</type>
			<tempdirectory>C:\Work\workspace\smartETLTest\temp</tempdirectory>
			<prefix>sort_</prefix>
			<sortsize>200</sortsize>
			<compress>true</compress>
			<uniquerows>false</uniquerows>
			<fields>
				<field>
					<name>id</name>
					<ascending>true</ascending>
					<casesensitive>true</casesensitive>
					<presorted>false</presorted>
				</field>
			</fields>
		</step>
	</steps>
	<flows>
		<!-- flow>
		<from>step1-CSVInput</from>
		<to>step 4-smart trans step</to>
	</flow>
	<flow>
		<from>step 4-smart trans step</from>
		<to>step3-CSVOutputSep</to>
	</flow-->
		<flow>
			<from>step1-CSVInput</from>
			<to>step7-sort</to>
		</flow>
		<flow>
			<from>step6-CSVInput</from>
			<to>step71-sort</to>
		</flow>
		<flow>
			<from>step7-sort</from>
			<to>step5-Join</to>
		</flow>
		<flow>
			<from>step71-sort</from>
			<to>step5-Join</to>
		</flow>
		<flow>
			<from>step5-Join</from>
			<to>step 4-smart trans step</to>
		</flow>
		<flow>
			<from>step 4-smart trans step</from>
			<to>step8-sort</to>
		</flow>
		<flow>
			<from>step8-sort</from>
			<to>step3-CSVOutputSep</to>
		</flow>
		<flow>
			<from>step1-CSVInput</from>
			<to>step1Output</to>
		</flow>
	</flows>
	<!--flow>
		<from>step1-CSVInput</from>
		<to>step5-Join</to>
	</flow>
	<flow>
		<from>step6-CSVInput</from>
		<to>step5-Join</to>
	</flow>
	<flow>
		<from>step5-Join</from>
		<to>step3-CSVOutputSep</to>
	</flow-->
	<!--flow>
		<from>step1-CSVInput</from>
		<to>step 5-smart trans step</to>
	</flow>
	<flow>
		<from>step 4-smart trans step</from>
		<to>step3-CSVOutputSep</to>
	</flow-->
	<datadefs>
		<datadef>
			<name>customer</name>
			<fields>
				<field>
					<name>id</name>
					<type>Integer</type>
					<length>3</length>
				</field>
				<field>
					<name>name</name>
					<type>String</type>
					<length>10</length>
				</field>
				<field>
					<name>firstname</name>
					<type>String</type>
					<length>13</length>
				</field>
				<field>
					<name>zip</name>
					<type>Integer</type>
					<length>5</length>
				</field>
				<field>
					<name>city</name>
					<type>String</type>
					<length>8</length>
				</field>
				<field>
					<name>birthdate</name>
					<type>Date</type>
					<length>10</length>
					<format>yyyy/mm/dd</format>
				</field>
				<field>
					<name>street</name>
					<type>String</type>
					<length>11</length>
				</field>
				<field>
					<name>housenr</name>
					<type>Integer</type>
					<length>3</length>
				</field>
				<field>
					<name>stateCode</name>
					<type>String</type>
					<length>9</length>
				</field>
				<field>
					<name>state</name>
					<type>String</type>
					<length>30</length>
				</field>
			</fields>
		</datadef>
		<datadef>
			<name>state</name>
			<fields>
				<field>
					<name>zip</name>
					<type>Integer</type>
					<length>5</length>
				</field>
				<field>
					<name>stateCode</name>
					<type>String</type>
					<length>9</length>
				</field>
				<field>
					<name>population</name>
					<type>Integer</type>
					<length>8</length>
				</field>
			</fields>
		</datadef>
		<datadef parent="customer">
			<name>outputcustomer</name>
			<fields>
				<field>
					<name>newfld</name>
					<type>String</type>
					<length>9</length>
				</field>
				<field>
					<name>lkfld</name>
					<type>Integer</type>
					<length>9</length>
				</field>
				<field>
					<name>population</name>
					<type>Integer</type>
					<length>9</length>
				</field>
			</fields>
			<excludes>
				<field>stateCode</field>
			</excludes>
		</datadef>
	</datadefs>
	<lookups>
		<lookup>
			<name>testlookup</name>
			<datadef ref="customer"/>
			<sourcetype>file</sourcetype>
			<file>
				<path>C:\Work\workspace\incredible\examples\customers1.txt</path>
				<delimiter>;</delimiter>
				<quote/>
			</file>
			<keys>
				<field>id</field>
				<field>name</field>
			</keys>
			<values>
				<field>firstname</field>
				<field>city</field>
			</values>
		</lookup>
	</lookups>
</job>
